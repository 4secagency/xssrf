<html>
    <head>
        <title>SecSec</title>
        <link rel="stylesheet" href="/modern.css"/>
    </head>
    <body>
        <div class="cover">
            <div class="header content">
                <div class="logo"><a href="/">SecSec</a></div>
                <ul class="menu">
                    <!--<li><a href="/menu/a">A</a></li>-->
                    <!--<li><a href="/menu/b">B</a></li>-->
                    <!--<li><a href="/menu/c">C</a></li>-->
                </ul>
                <a class="login" href="/wp-admin/">
                    WP
                </a>
            </div>
            <div class="content">
                <svg width="128" height="128" class="octicon octicon-shield" viewBox="0 0 14 16" version="1.1" aria-hidden="true"><path fill="#ffffff" fill-rule="evenodd" d="M7 0L0 2v6.02C0 12.69 5.31 16 7 16c1.69 0 7-3.31 7-7.98V2L7 0zM5 11l1.14-2.8a.568.568 0 0 0-.25-.59C5.33 7.25 5 6.66 5 6c0-1.09.89-2 1.98-2C8.06 4 9 4.91 9 6c0 .66-.33 1.25-.89 1.61-.19.13-.3.36-.25.59L9 11H5z"></path></svg>
                <p>A random blog of some IT Sec guy.</p>
                <!--<button class="primary">Some</button>-->
                <!--<button class="secondary">Links</button>-->
            </div>
        </div>
        <div class="page">
            <div class="content">
                <div class="article">
                    <div class="title">man hexdump</div>
                    <div class="info">By <a class="link" href="/user/0">root</a></div>
                    <div class="content">
                        When working with binaries there is one tool you just can't omit, especially when working on a console:
                        <pre class="sh">hexdump</pre>
                        But how can <i class="sh">hexdump</i> help me reading binary data you ask?
                        <br/><br/>
                        The tool shows the file content byte per byte in
                        hexadecimal notation side by side with their ASCII representations (if printable).
                        <br/><br/>
                        As an example when looking for ASCII hidden in, for example an image,
                        you could run:
                        <pre class="sh">hexdump -C image.jpg</pre>
                        and would get something similar to the following output:
                        <pre class="sh">
00000000  ff d8 ff e0 00 10 4a 46  49 46 00 01 01 02 00 25  |......JFIF.....%|
00000010  00 25 00 00 ff db 00 43  00 03 02 02 02 02 02 03  |.%.....C........|
00000020  02 02 02 03 03 03 03 04  06 04 04 04 04 04 08 06  |................|
00000030  06 05 06 09 08 0a 0a 09  08 09 09 0a 0c 0f 0c 0a  |................|
00000040  0b 0e 0b 09 09 0d 11 0d  0e 0f 10 10 11 10 0a 0c  |................|
00000050  12 13 12 10 13 0f 10 10  10 ff db 00 43 01 03 03  |............C...|
00000060  03 04 03 04 08 04 04 08  10 0b 09 0b 10 10 10 10  |................|
00000070  10 10 10 10 10 10 10 10  10 10 10 10 10 10 10 10  |................|
*
00000090  10 10 10 10 10 10 10 10  10 10 10 10 10 10 ff c0  |................|
000000a0  00 11 08 00 4b 00 d1 03  01 11 00 02 11 01 03 11  |....K...........|
000000b0  01 ff c4 00 1d 00 00 02  02 03 01 01 01 00 00 00  |................|
000000c0  00 00 00 00 00 00 00 08  06 07 04 05 09 03 02 01  |................|
000000d0  ff c4 00 51 10 00 01 03  03 03 02 03 03 05 08 0c  |...Q............|
000000e0  0c 07 00 00 00 01 02 03  04 05 06 11 00 07 12 08  |................|
000000f0  21 13 31 41 09 14 22 23  32 51 61 71 15 16 17 33  |!.1A.."#2Qaq...3|
00000100  52 73 81 91 19 24 35 38  42 58 62 75 a1 b2 b5 d3  |Rs...$58BXbu....|
00000110  18 39 43 56 57 72 82 92  95 a2 a4 d4 63 93 94 96  |.9CVWr......c...|
00000120  a3 b4 d2 ff c4 00 1b 01  01 00 02 03 01 01 00 00  |................|
00000130  00 00 00 00 00 00 00 00  00 01 04 02 03 07 06 05  |................|
...
                        </pre>
                        Depending on the file format you could probably spot any hidden data.
                    </div>
                    <ul class="tags">
                        <li><a><button class="primary">Linux</button></a></li>
                        <li><a><button class="primary">hexdump</button></a></li>
                        <li><a><button class="primary">Binary</button></a></li>
                    </ul>
                </div>
                <div class="article">
                    <div class="title">Something different</div>
                    <div class="info">By <a class="link" href="/user/0" class="author">root</a></div>
                    <div class="content">
                        And now for something completely different.
                    </div>
                    <ul class="tags">
                        <li><a><button class="primary">Python</button></a></li>
                        <li><a><button class="primary">Monty</button></a></li>
                    </ul>
                </div>
                <div class="article">
                    <div class="title">Binary obfuscation</div>
                    <div class="info">By <a class="link" href="/user/0" class="author">root</a></div>
                    <div class="content">
                        Lately a friend showed me an interesting attempt in obfuscation binary data.
                        When analysing executables one common technique is to run <i class="sh">strings</i>
                        on the file to show ASCII-printable character contained in the binary stream.
                        <br/><br/>
                        As a little demonstration take a look at the following C program:
                        <pre class="c">
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

char *password = "SecretPassword";

int main(int argc, char *argv[]) {
	if (argc < 2) {
		printf("No Password provided!\n");
		return 1;
	}
	int len = strlen(argv[1]);
	char *input = malloc(len + 1);
	strncpy(input, argv[1], len);
	input[len] = 0;
	if(strcmp(input, password) != 0) {
		printf("Invalid password!\n");
		return 2;
	}
	printf("Well done!\n");
	return 0;
}
                        </pre>
                        When trying to guess the password without looking at the source code. You could try running:
                        <pre class="sh">
$ ./example a
Invalid password!
$ ./example b
Invalid password!
...
[repeat for a long time]
...
$ ./example SecretPassworc
Invalid password!
$ ./example SecretPassword
Well done!
                        </pre>
                        If running <i class="sh">strings example</i> you might get something like the following:
                        <pre class="sh">
...
AWAVI
AUATL
[]A\A]A^A_
SecretPassword
No Password provided!
Invalid password!
Well done!
;*3$"
GCC: (GNU) 2.7.0 19950616
...
                        </pre>
                        You could then just guess the right or try all string until you find the correct password.
                        <br/><br/>
                        To prevent this, my friend showed me how to obfuscate strings by using a so called caesar cipher.
                        Caesar cipher are quite simple.
                        You just take each character and offset it a defined value in the alphabet.
                        <br/>
                        As an example the text <i>Hello</i> using a shift by 3 would be encoded as <i>Khoor</i> which is unreadable without knowledge of the shift.
                        <br/><br/>
                        But to use it on any string you have to use 0 to 255 as the alphabet and encode the string byte per byte.
                        The following C code has been modified so the secret string is shifted by 16:
                        <pre class="c">
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

int shift = 16;
char *password = "\x63\x75\x73\x82\x75\x84\x60\x71\x83\x83\x87\x7F\x82\x74";

int main(int argc, char *argv[]) {
	if (argc < 2) {
		printf("No Password provided!\n");
		return 1;
	}
	int len = strlen(argv[1]);
	char *input = malloc(len + 1);
	strncpy(input, argv[1], len);
	input[len] = 0;
	int pLen = strlen(password);
	int i;
	char equal = len == pLen ? 1 : 0;
	while (equal == 1 && i < len && i < pLen) {
		if (password[i] != input[i] + shift) {
			equal = 0;
		}
		i++;
	}
	if(equal == 0) {
		printf("Invalid password!\n");
		return 2;
	}
	printf("Well done!\n");
	return 0;
}
                        </pre>
                        When running <i class="sh">strings</i> on the new binary, the secret string disappeared.
                        <pre class="sh">
...
AWAVI
AUATL
[]A\A]A^A_
No Password provided!
Invalid password!
Well done!
;*3$"
GCC: (GNU) 2.7.0 19950616
...
                        </pre>
                        Below is an example in JavaScript which works in your browser and interpretes each character of the input as hexadecimal number.
                        Isn't this great?!
                        <br/>
                        <table>
                            <tr>
                                <td>Shift:</td>
                                <td>
                                    <select id="caesarShift" onchange="update()">
                                        <option value="0">0</option>
                                        <option value="1">1</option>
                                        <option value="2">2</option>
                                        <option value="3">3</option>
                                        <option value="4">4</option>
                                        <option value="5">5</option>
                                        <option value="6">6</option>
                                        <option value="7">7</option>
                                        <option value="8">8</option>
                                        <option value="9">9</option>
                                        <option value="10">10</option>
                                        <option value="11">11</option>
                                        <option value="12">12</option>
                                        <option value="13">13</option>
                                        <option value="14">14</option>
                                        <option value="15">15</option>
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <td>Text:</td>
                                <td><input id="caesarText" onkeyup="update()" type="text" maxlength="24" size="24"/></td>
                            </tr>
                            <tr>
                                <td>Result:</td>
                                <td><input id="caesarResult" type="text" maxlength="24" size="24" readonly/></td>
                            </tr>
                        </table>
                    </div>
                    <ul class="tags">
                        <li><a><button class="primary">Caesar</button></a></li>
                        <li><a><button class="primary">Obfuscation</button></a></li>
                        <li><a><button class="primary">Strings</button></a></li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="footer">
            !Powered by WordPress
        </div>
    </body>
</html>
